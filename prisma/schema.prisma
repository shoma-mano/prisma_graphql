datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  // previewFeatures = []
}


generator dbml {
  provider = "prisma-dbml-generator"
}

generator nestgraphql {
    provider = "node node_modules/prisma-nestjs-graphql"
    output = "../src/@generated/prisma-nestjs-graphql"
    noAtomicOperations=true
}

generator docs {
  provider = "node node_modules/prisma-docs-generator"
}

model User {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  email     String   @unique
  password  String
  firstname String?
  ///苗字
  lastname  String?
  posts     Post[]
  role      Role
}

model Post {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  published Boolean
  title     String
  content   String?
  author    User?    @relation(fields: [authorId], references: [id])
  authorId  String?
}

enum Role {
  ADMIN
  USER
}

///商品詳細ページ
model Detail {
  id              Int               @id @default(autoincrement())
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  name            String
  img             String
  price           Int
  sentence        String
  menu            Menu?
  options DetailOnOptions[]
}

model Menu {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  name      String
  img       String
  detail    Detail?  @relation(fields: [detailId], references: [id])
  ///商品詳細ページ
  detailId  Int?      @unique
  category  String
}

model Option {
  id        Int               @id @default(autoincrement())
  createdAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt
  name      String
  details   DetailOnOptions[]
}

model DetailOnOptions {
  option     Option   @relation(fields: [optionId], references: [id])
  optionId   Int
  detail     Detail   @relation(fields: [detailId], references: [id])
  detailId   Int
  assignedAt DateTime @default(now())
  assignedBy String

  @@id([optionId, detailId])
}
